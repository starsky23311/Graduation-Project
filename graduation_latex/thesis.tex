% !Mode:: "TeX:UTF-8"
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%          ,
%      /\^/`\
%     | \/   |                CONGRATULATIONS!
%     | |    |             SPRING IS IN THE AIR!
%     \ \    /                                                _ _
%      '\\//'                                               _{ ' }_
%        ||                     hithesis v3                { `.!.` }
%        ||                                                ',_/Y\_,'
%        ||  ,                   dustincys                   {_,_}
%    |\  ||  |\          Email: yanshuoc@gmail.com             |
%    | | ||  | |            https://yanshuo.name             (\|  /)
%    | | || / /                                               \| //
%    \ \||/ /       https://github.com/dustincys/hithesis      |//
%      `\\//`   \\   \./    \\ /     //    \\./   \\   //   \\ |/ /
%     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[fontset=fandol,type=bachelor,campus=harbin]{hithesisbook}
% 此处选项中不要有空格
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 必填选项
% type=doctor|master|bachelor|postdoc
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 选填选项（选填选项的缺省值已经尽可能满足了大多数需求，除非明确知道自己有什么
% 需求）
% campus=shenzhen|weihai|harbin
%   含义：校区选项，默认harbin
% glue=true|false
%   含义：由于我工规范中要求字体行距在一个闭区间内，这个选项为true表示tex自
%   动选择，为false表示区间内一个最接近版心要求行数的要求的默认值，缺省值为
%   false。
% tocfour=true|false
%   含义：是否添加第四级目录，只对本科文科个别要求四级目录有效，缺省值为
%   false
% fontset=windows|mac|ubuntu|fandol|adobe
%   含义：设置字体，默认情况会自动识别系统，然后设置字体。后两个是开源字体，自行
%   下载安装后设置使用。windows是中易字库，窝工默认常用字体，绝对没毛病。mac和
%   ubuntu 默认分别是华文和思源字库，理论上用什么字库都行。后两种开源字库的安装
%   方法到谷歌上百度一下什么都有了。Linux非ubuntu发行版、非x86架构机器等如何运行
%   可到github issue上讨论。
% tocblank=true|false
%   含义：目录中第一章之前，是否加一行空白。缺省值为true。
% chapterhang=true|false
%   含义：目录的章标题是否悬挂居中，规范中要求章标题少于15字，所以这个选项
%   有无没什么用，除了特殊需求。缺省值为true。
% fulltime=true|false
%   含义：是否全日制，缺省值为true。非全日制如同等学力等，要在cover中设置类
%   型，封面中不同格式
% subtitle=true|false
%   含义：论文题目是否含有副标题，缺省值为false，如果有要在cover中设置副标
%   题内容，封面中显示。
% newgeometry=one|two|no
%   含义：规范中的自相矛盾之处，版芯是否包含页眉页脚，旧方法是按照包含页眉
%   页脚来设置。该选项是多选选项，如果设置为no，则版新为旧模板的版芯设置方法，
%   如果设置该选项one或two，分别对应两种页眉页码对应版芯线的相对位置。第一种
%   是严格按照规范要求，难看。第二种微调了页眉页码位置，好一点。默认two。
% debug=true|false
%   含义：是否显示版芯框和行号，用来调试。默认否。
% openright=true|false
%   含义：博士论文是否要求章节首页必须在奇数页，此选项不在规范要求中，按个
%   人喜好自行决定。 默认否。注意，窝工的默认情况是打印版博士论文要求右翻页
%   ，电子版要求非右翻页且无空白页。如果想DIY（或身不由己DIY）在什么地方右
%   翻页，将这个选项设置为false，然后在目标位置添加`\cleardoublepage`命令即
%   可。
% library=true|false
%   含义：是否为提交到图书馆的电子版。默认否。注意：如果设置成true，那么
%   openright选项将被强制转换为false。
% capcenterlast=true|false
%   含义：图题、表题最后一行是否居中对齐（我工规范要求居中，但不要求居中对
%   齐），此选项不在规范要求中，按个人喜好自行决定。默认否。
% subcapcenterlast=true|false
%   含义：子图图题最后一行是否居中对齐（我工规范要求居中，但不要求居中对齐
%   ），此选项不在规范要求中，按个人喜好自行决定。默认否。
% absupper=true|false
%   含义：中文目录中的英文摘要在中文目录中的大小写样式歧义，在规范中要求首
%   字母大写，在work样例中是全大写。该选项控制是否全大写。默认否。
% bsmainpagenumberline=true|false
%   含义：由于本科生论文官方模板的页码和页眉格式混乱，提供这个选项自定义设
%   置是否在正文中显示页码横线，默认否。
% bsfrontpagenumberline=true|false
%   含义：由于本科生论文官方模板的页码和页眉格式混乱，提供这个选项自定义设
%   置是否在前文中显示页码横线，默认否。
% bsheadrule=true|false
%   含义：由于本科生论文官方模板的页码和页眉格式混乱，提供这个选项自定义设
%   置是否显示页眉横线，默认显示。
% splitbibitem=true|false
%   含义：参考文献每一个条目内能不能断页，应广大刀客要求添加。默认否。
% newtxmath=true|false
%   含义：数学字体是否使用新罗马。默认是。
% chapterbold=true|false
%   含义：本科生章标题在目录和正文中是否加粗
% engtoc=true|false
%   含义：非博士生需要添加英文目录的，手动添加，如果是博士，此开关无效
% zijv=word|regu
%   含义：字距设置为规范规定33个字还是word中34个字。默认regu。
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{hithesis}

\graphicspath{{./figures/}}

\begin{document}
\frontmatter
\input{front/cover} % 封面
\makecover
\input{front/denotation}%物理量名称表,符合规范为主，有要求添加
\tableofcontents %目录
\mainmatter
%\include{body/xulun}













%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%绪论%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter[绪论]{绪论}

研究生学位论文是研究生科学研究工作的全面总结，是描述其研究成果、代表其研究水平的
重要学术文献资料，是申请和授予相应学位的基本依据。学位论文撰写是研究生培养过程的
基本训练之一，必须按照确定的规范认真执行。研究生应严肃认真地撰写学位论文，指导教
师应加强指导，严格把关。

学位论文撰写应实事求是，杜绝造假和抄袭等行为；应符合国家及各专业部门制定的有关标
准，符合汉语语法规范。硕士和博士学位论文，除在字数、理论研究的深度及创造性成果等
方面的要求不同外，撰写规范要求基本一致。人文与社会科学、管理学科可在本撰写规范的
基础上补充制定专业的学术规范。

\section{课题背景及研究的目的和意义}[Content specification]
要不看看自己开题文章的开头？

\section{机器人视觉伺服系统概述}[Content specification]
分IBVS、PBVS和混合控制hvs。IBVS的基础原理从最原始的公式、解耦、图像矩到现在借助神经网络获直接端到端控制。绕不开当前特征与目标特征的提取的过程，但是方法越来越具有泛化性。
\section{基于视觉伺服的物体抓取发展现状}[Content specification]
抓取方法上：
经典的方法当然是人为的制作特征点或者标志，辅助视觉伺服。但是泛化性是不行的，需要避免人为的制作特征，让程序自主提取特征并生成目标。直接把整张图当作特征是后来的发展方向之一，这样必须要求目标与当前相似，伺服范围太小。神经网络兴起后，方法变得百花齐放。如现在不断发展的抓取合成（grasp systhesis），分经验法和深度法;神经网络自主生成目标图像但还是那个问题，这样必须要求目标与当前相似，伺服范围太小;手到眼系统，神经网络估计机械臂末端和目标的相对位姿，伺服后期会出现遮挡现象，一般还是要配合眼在手系统一起使用，涉及到多数据融合问题，非常复杂。通过渲染引擎获得目标图像，神经网络自动提取特征并匹配特征。大部分的方法无法回避需要线下制作目标图像的问题，对于一个完全未知的目标，如何在线上就能实时生成目标并执行抓取是对抓取未知目标任务的研究重点。
伺服性能上：
就算拥有一个合适的抓取方法，也需要有合适的控制律。低鲁棒性的伺服控制律，无法在应对各种位姿、形态的抓取对象中保证同样的抓取性能，这会大大降低最终的抓取成功率和伺服响应速度。为满足泛化性的需求，近几年有很多人投入到视觉伺服控制律的研究中，然后介绍各种控制方法。如何设计一个适合于当前抓取方法的控制律，是抓取未知目标任务的又一难点。

\section{主要研究内容及章节安排}[Content specification]
介绍本文都要干些啥，IBVS相对于PBVS的优势，eye-to-hand系统
本文共分为六章，章节内容如下  
第一章：  
第二章：  
。。。





%%%%%%%%%%%%%%%%%%%%%%%%基于图像的视觉伺服理论研究%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter[基于图像的视觉伺服（IBVS）理论研究]{基于图像的视觉伺服（IBVS）理论研究}
\section{引言}[Content specification]
绪论中介绍了IBVS相对于PBVS的优势：1.伺服精度不依赖于相机外参，深度鲁棒性强;2.直接得到指令，不需要轨迹规划，更易于实现实时闭环控制。因此认为IBVS更适合于未知位姿、形体的目标的抓取任务。IBVS作为本算法研究的基石之一，尤其需要十分严谨合理的模型建立、公式原理分析、完善的仿真系统和实物环境搭建，这会为之后的工作减少不少麻烦。本章中除了完成上述基础性工作，还在实物上成功运行了简单的基于特征点交互矩阵的IBVS。

\section{IBVS系统模型建立}[Content specification]
\subsection{系统坐标系建立}[Content specification]
对于IBVS系统，最需要关注的点有三个：机械臂末端、相机和目标。为了后续仿真程序实现和问题分析需要，建立系统的坐标系用于表述它们的位置。{\color{red}如图？所示}。


该示意图中，$\lbrace$\textit{O}$\rbrace$、$\lbrace$\textit{E}$\rbrace$和$\lbrace$\textit{C}$\rbrace$分别表示物体坐标系、机器人末端坐标系，eye-to-hand系统中的相机坐标系。为了便于阐述坐标变换公式，用$\lbrace$\textit{B}$\rbrace$、$\lbrace$\textit{I}$\rbrace$和$\lbrace$\textit{CI}$\rbrace$表示机器人基坐标系、图像坐标系和像素坐标系。{\color{red}各种相对位置}\cite{zh1}。
\subsection{视觉模型建立}[Content specification]
不例外地使用针孔模型描述从机器人基坐标系中的物体到像素坐标系的映射。

\section{IBVS仿真系统实现}[Content specification]
\subsection{IBVS算法原理}[Content specification]

\subsection{机器人仿真模型搭建}[Content specification]
基于为整个系统搭建的坐标系和不同系的坐标转换关系，借助ROS的moveit工具（由于ROS2的moveit2尚未开发成熟，使用moveit代替），为敬科公司提供的JK机器人搭建仿真模型。moveit是一个开发的十分完善的工具包，不仅实现了机械结构的仿真，物理模型、碰撞体积和逆运动学都在包中相应地实现。本研究中，为了能更快地验证提出的算法，减少繁杂的视觉处理，将把物体放到一个平整且颜色单一（在后续的研究中可以发现这些要求都不是必须的）的表面上。{\color{red}仿真效果图如下图所示}。


{\color{red}图？}展现了整个系统的控制方框图，{\color{red}加入中期答辩的话}。


开启仿真节点后，可以在另一个节点中与该节点建立连接并发送速度指令，仿真节点会因此响应，并进行移动。moveit有自己的限位系统，在机器人进入奇异点或者超出移动范围时给予及时的警告，所以该机器人仿真模型多被用于对机器人是否进入奇异点的判断这样的定性分析，后文中真正的调参还是在实物上进行的。
\subsection{曲线绘制与相机轨迹记录}[Content specification]
曲线是分析问题非常重要的一环，所以仿真中应当有相应的曲线绘制。IBVS本质是将特征偏差作为控制器输入而映射成速度指令的控制系统，所以研究中最关心的是点在于特征偏差和速度指令，它们将被分别绘制到两张图中。曲线图中时间单位为秒。关于特征偏差图：系统中定义特征偏差是相机坐标系中被检测的特征点在X、Y方向的偏差，单位为米，该单位不被展现在曲线中，因为它的单位并不重要。关于末端速度指令图：为了与JK机器人需要的末端速度指令单位保持一致，所以线速度选取厘米每秒为单位，而角速度单位则为度每秒。


直观地展现相机的位移情况也是重要的，因为IBVS往往对机器人末端的运动轨迹十分不友好。如果当前的速度指令使机器人颤振，那么机器人已经进入了一个十分糟糕的姿态，通过分析相机的运动轨迹适当调节控制律参数也是非常好的解决方法。调用VISP库，对设定的参数进行视觉伺服仿真，实现的曲线绘制和相机轨迹绘制效果{\color{red}如图？所示}。


提前在程序中设置好特征的位置，和与之对应的目标特征。将仿真得到的速度指令通过ROS2节点发布订阅机制传输给机器人仿真节点，机器人会相应地运动并使当前特征都到达目标特征处，从而到成到达目标位置处的目的，效果{\color{red}如图？所示}。
\section{IBVS实际系统实现}[Content specification]
\subsection{IBVS实物系统平台搭建}[Content specification]
仿真终归只能用于定性分析。外界干扰、噪声多种多样，仿真中不可能把所有因素考虑进去。事实上，仿真跑出的结果往往十分顺滑，而实物中会反映很多处理不够细节的问题。我认为，IBVS算法在实物上成功运行，研究才算真正的开始。实物运行环境包括JK机器人和装载它并固定它底座的台子;用于承载目标物体的平台和目标;平台上铺盖的一层漫反射效果好且为单一白色的纸;机器人末端装配Realsense D435i深度相机（夹具暂时未装配，在正式夹取的时候会安装在末端）。之所以要铺一层纸，除了保证平面平整且颜色单一以外，还保证了深度相机不要因为丢失反射光导致获取无效数据。最终实物环境图{\color{red}如图？所示}：





\subsection{IBVS实际运行}[Content specification]
为了能更快地验证IBVS算法，在平台上贴了一张黑色方框码，经过视觉二值化、边缘获取、多边形拟合等处理。实验进行前会将机械臂末端调到目标位置，此时黑色方框会处于摄像头的中央，记录此时的四个点为目标特征。将机器人末端初始位置调至远离黑色方框的位置，距离目标位置的三维各个方向以及Z轴角度都有一定的偏差{\color{red}（机器人基坐标系中，X方+0.3m,Y方向Z）}。伺服过程中会不断捕获它的四个点作为特征，并计算特征偏差，最后映射成末端速度指令。伺服的成功证实了所实现的IBVS算法的正确性，同时也正式踏入对未知物体视觉伺服抓取的研究领域中。{\color{red}图？}展示了伺服前后机械臂的状态以及对应的曲线、相机轨迹：

\section{本章总结}[Content specification]
本章讲述了基于特征点交互矩阵的IBVS的原理。在算法实现前建立系统坐标系和视觉坐标系，这会使之后的坐标描述便捷许多。搭建了IBVS的仿真运行环境，便于后续问题分析。搭建了实物运行环境，并成功运行了IBVS算法，这意味着研究真正的开始。
%%%%%%%%%%%%%%%%%%%%%%%%%%%抓取目标生成算法研究%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter[抓取目标生成算法研究]{抓取点生成算法研究}
\section{引言}[Content specification]



\section{机器人视觉伺服系统概述}[Content specification]




%%%%%%%%%%%%%%%%%%基于GG-CNN和IBVS的未知物体抓取算法实现%%%%%%%%%%%%%%%%%%%
\chapter[基于GG-CNN和IBVS的未知物体抓取算法实现]{基于GG-CNN和IBVS的未知物体抓取算法实现}
\section{引言}[Content specification]


\section{机器人视觉伺服系统概述}[Content specification]



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%IBVS控制律优化%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter[IBVS控制律优化]{IBVS控制律优化}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%实验设计与验证%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{实验设计与验证}



\include{body/introduction}

\backmatter
\include{back/conclusion}   % 结论
\bibliographystyle{hithesis} %如果没有参考文献时候
\bibliography{reference}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%-- 注意：以下本硕博、博后书序不一致 --%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% 硕博书序
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%\begin{appendix}%附录
%\input{back/appA.tex}
%\end{appendix}
%\include{back/publications}    % 所发文章
%\include{back/ceindex}    % 索引, 根据自己的情况添加或者不添加，选择自动添加或者手工添加。
%\authorization %授权
%%\authorization[scan.pdf] %添加扫描页的命令，与上互斥
%\include{back/acknowledgements} %致谢
%\include{back/resume}          % 博士学位论文有个人简介
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% 本科书序为：
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 \authorization %授权
 % \authorization[scan.pdf] %添加扫描页的命令，与上互斥
 \include{back/acknowledgements} %致谢
% \begin{appendix}%附录
% \input{back/appendix01}%本科生翻译论文
% \end{appendix}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% 博后书序
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% \include{back/acknowledgements} %致谢
% \include{back/doctorpublications}    % 所发文章
% \include{back/publications}    % 所发文章
% \include{back/resume}          % 博士学位论文有个人简介
% \include{back/correspondingaddr} %通信地址
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\end{document}
% Local Variables:
% TeX-engine: xetex
% End:
